
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../equations/">
      
      
        <link rel="next" href="../about/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Solvers - Dyablo-Whole Sun</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#solvers-and-discretization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Dyablo-Whole Sun" class="md-header__button md-logo" aria-label="Dyablo-Whole Sun" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dyablo-Whole Sun
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Solvers
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Dyablo-Whole Sun" class="md-nav__button md-logo" aria-label="Dyablo-Whole Sun" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Dyablo-Whole Sun
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../equations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Equations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Solvers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Solvers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#discretization" class="md-nav__link">
    <span class="md-ellipsis">
      Discretization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-stepping" class="md-nav__link">
    <span class="md-ellipsis">
      Time stepping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyperbolic-flux-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Hyperbolic flux calculation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface-values" class="md-nav__link">
    <span class="md-ellipsis">
      Interface values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solenoidal-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Solenoidal constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timestep-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Timestep calculation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Future considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../boundary_conditions.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary Conditions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setups.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setups
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#discretization" class="md-nav__link">
    <span class="md-ellipsis">
      Discretization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-stepping" class="md-nav__link">
    <span class="md-ellipsis">
      Time stepping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyperbolic-flux-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Hyperbolic flux calculation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface-values" class="md-nav__link">
    <span class="md-ellipsis">
      Interface values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solenoidal-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Solenoidal constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timestep-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Timestep calculation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Future considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="solvers-and-discretization">Solvers and discretization</h1>
<p>This page describes the solver implemented in Dyablo-Whole Sun.</p>
<h2 id="discretization">Discretization</h2>
<p>We employ a finite-volume discretization of space. Considering a physical solution for the <a href="../equations/">equations</a> under the form of a conservative variable vector space $\mathbf{\tilde{U(x, y, z, t)}} defined on every point of space at a given time <span class="arithmatex">\(t\)</span> we represent the solution as volume averages on a (adaptive) grid. For an element <span class="arithmatex">\(\mathbf{i}\)</span> of this grid spanning from <span class="arithmatex">\([x_{\mathbf{i}-(1/2,0,0)}, y_{\mathbf{i}-(0,1/2,0)}, z_{\mathbf{i}-(0,0,1/2)}]\)</span> to <span class="arithmatex">\([x_{\mathbf{i}+(1/2,0,0)}, y_{\mathbf{i}+(0,1/2,0)}, z_{\mathbf{i}+(0,0,1/2)}]\)</span> we approximate the physical solution as :</p>
<div class="arithmatex">\[
\mathbf{U}_{\mathbf{i}}(t) = \dfrac{1}{V_{\mathbf{i}}}\int\int\int \mathbf{\tilde{U}}(x, y, z, t)dxdydz
\]</div>
<p>Where <span class="arithmatex">\(V_{\mathbf{i}}\)</span> is the volume of the element of the grid at index <span class="arithmatex">\(\mathbf{i}\)</span></p>
<h2 id="time-stepping">Time stepping</h2>
<p>For now, only explicit time-stepping is available in Dyablo. The calculations splits the hyperbolic, the parabolic and the source terms in different updates. We use operator splitting operations to separate all treatments. The two solvers available for now are a first order forward Euler method and a strong-stability preserving second order Runge-Kutta scheme. To evolve from a time given at iteration <span class="arithmatex">\(n\)</span> to the next iteration <span class="arithmatex">\(n+1\)</span> at time <span class="arithmatex">\(t+\Delta t\)</span>, we write the semi-discretized formulation for the hyperbolic terms of these schemes as the following [the formulation stays similar for the parabolic and source terms]:</p>
<p><strong>First order Euler integrator:</strong></p>
<div class="arithmatex">\[
\mathbf{U}^{n+1}_\mathbf{i} = \mathbf{U}^n_\mathbf{i} - \Delta t (\nabla \cdot \mathbf{F}(\mathbf{U}_\mathbf{i}))
\]</div>
<p><strong>Second order strong-stability preserving Runge-Kutta:</strong></p>
<div class="arithmatex">\[
\mathbf{U}^*_\mathbf{i} = \mathbf{U}^n_\mathbf{i} - \Delta t (\nabla \cdot \mathbf{F}(\mathbf{U})) \\
\mathbf{U}^{n+1}_\mathbf{i} = \dfrac{1}{2}(\mathbf{U}^n_\mathbf{i} + \mathbf{U}^*_\mathbf{i} - \Delta t (\nabla \cdot \mathbf{F}(\mathbf{U^*_\mathbf{i}})))
\]</div>
<h2 id="hyperbolic-flux-calculation">Hyperbolic flux calculation</h2>
<p>In order to solve the hyperbolic terms, we need to calculate the divergence of the flux. For this, we employ the Godunov method and use the divergence theorem to rewrite the evolution equation as the sum of the fluxes on the areas of the cell. We orient the fluxes toward the positive axes of the Cartesian domain, and thus, a positive flux on the "left" of a cell means "entering flux" while a positive flux on the "right" of a cell means "exiting flux". To simplify the following, we write the discretization in 1D but the 2D and 3D cases are discretized similarly along each directions:</p>
<div class="arithmatex">\[
\dfrac{\partial \mathbf{F}(\mathbf{U}_i^n)}{\partial x} = \dfrac{1}{V_i}(A^x_{i-1/2} \mathbf{F}(\mathbf{U}_{i-1/2}) - A^x_{i+1/2} \mathbf{F}(\mathbf{U}_{i+1/2}))
\]</div>
<p>where <span class="arithmatex">\(A^x_{i-1/2}\)</span> is the area on the left face along the x direction, and similarly for the right face. Note that since Dyablo is using adaptive mesh refinement, in the case where the neighbor is non conformal and multiple, the left and/or right terms are representing a sum of fluxes multiplied by their corresponding areas.</p>
<p>To simplify the following notations we write the flux at the interface as: </p>
<div class="arithmatex">\[
\mathbf{F}_{i-1/2} := \mathbf{F}(\mathbf{U}^n_{i-1/2})
\]</div>
<p>Every update along each direction is done at the same time in the <strong>unsplit Godunov</strong> way. If we were to write the complete update for the first order Euler timestepping on a regular 3D grid as an example, this would give:</p>
<div class="arithmatex">\[
\begin{split}
\mathbf{U}^{n+1}_i = \mathbf{U}^n_i &amp;+ \dfrac{\Delta t}{\Delta x}(\mathbf{F}_{i-1/2} - \mathbf{F}_{i+1/2}) \\ 
                                    &amp;+ \dfrac{\Delta t}{\Delta y}(\mathbf{G}_{j-1/2} - \mathbf{G}_{j+1/2}) \\
                                    &amp;+ \dfrac{\Delta t}{\Delta z}(\mathbf{H}_{k-1/2} - \mathbf{H}_{k+1/2})
\end{split}
\]</div>
<p>Where we only write the relevant indices for the fluxes. Also it is important to note here that the volume and area terms can be simplified since the grid is regular. This is not the case in AMR anymore where one flux can be the sum of multiple smaller fluxes in the case of a non-conformal neighbor. </p>
<p>To calculate the update, we are left with the calculation of the values of the fluxes at the interfaces along each direction. To do this, we solve the <strong>Riemann problem</strong> at the interface between the <strong>primitive</strong> state on the left of the interface (<span class="arithmatex">\(\mathbf{Q}_L\)</span>) and the primitive state on the right of the interface (<span class="arithmatex">\(\mathbf{Q}_R\)</span>) : </p>
<div class="arithmatex">\[
\mathbf{F}_{i-1/2} = \mathbf{F}(\mathcal{R}(\mathbf{Q}^n_L, \mathbf{Q}^n_R))
\]</div>
<p>The Riemann solvers implemented in Dyablo are: </p>
<ul>
<li><strong>HLLC</strong> (Toro 2009) for Hydrodynamics problems</li>
<li><strong>HLLD</strong> (Miyoshi, Kusano 2005) for MHD problems</li>
<li><strong>Five-Waves</strong> (Bourgeois in prep 2024) for MHD problems</li>
</ul>
<h2 id="interface-values">Interface values</h2>
<p>The reconstruction of the values at the interfaces before the resolution of the Riemann problem can be picked among three choices : </p>
<ul>
<li><strong>Piecewise constant method</strong> (order 1): <span class="arithmatex">\(\mathbf{Q}_{i-1/2} = \mathbf{Q}_i\)</span></li>
<li><strong>Piecewise linear method</strong> (order 2): <span class="arithmatex">\(\mathbf{Q}_{i-1/2} = \mathbf{Q}_i - \dfrac{\Delta x}{2}\mathbf{S}_x\)</span>, with <span class="arithmatex">\(\mathbf{S}_x\)</span> a limited slope, as defined later.</li>
<li><strong>Well-balanced</strong> (order 1) (Kappelli 2012), which uses a piecewise constant method for all the variables except the pressure which is reconstructed to guarantee hydrostatic equilibrium : <span class="arithmatex">\(P_{i-1/2} = P_i - \rho_i g \dfrac{\Delta x}{2}\)</span>. With <span class="arithmatex">\(g\)</span> the value of the gravitational acceleration along that direction.</li>
</ul>
<p>The slope <span class="arithmatex">\(\mathbf{S}_x\)</span> is calculated using the slope on the left, and the right of the cell, and is then limited: </p>
<div class="arithmatex">\[
\begin{split}
  \mathbf{S}_x^L &amp;= \dfrac{\mathbf{Q}_i-\mathbf{Q}_{i-1}}{\Delta x} \\
  \mathbf{S}_x^R &amp;= \dfrac{\mathbf{Q}_{i+1}-\mathbf{Q}_{i}}{\Delta x} \\
  \mathbf{S}_x &amp;= \Phi(\mathbf{S}_x^L, \mathbf{S}_x^R)
\end{split}
\]</div>
<p>with <span class="arithmatex">\(\Phi(a, b)\)</span> a slope limiter. Currently, in the Whole-Sun branch, only a <strong>minmod</strong> limiter is available:</p>
<div class="arithmatex">\[
\Phi_{minmod}(a, b) = \begin{cases}
  0 &amp;\text{if } ab &lt; 0 \\
  a &amp;\text{if } |a| &lt; |b| \\
  b &amp;\text{else}
\end{cases}
\]</div>
<h2 id="solenoidal-constraint">Solenoidal constraint</h2>
<p>To guarantee the solenoidal constraint <span class="arithmatex">\(\nabla\cdot \mathbf{B}=0\)</span> we need to implement additional mechanisms. For now in Dyablo, two solutions are implemented:</p>
<ul>
<li>Using an entropy-preserving scheme (Five-Waves) to make sure <span class="arithmatex">\(\nabla \cdot \mathbf{B}\)</span> stays low and bounded.</li>
<li>Using a Generalized Lagrange Method (GLM) for MHD (Dedner 2002).</li>
</ul>
<p>In the case of GLM-MHD, we need to include one additional variable <span class="arithmatex">\(\psi\)</span> that will account for the numerical error in <span class="arithmatex">\(\nabla\cdot\mathbf{B}\)</span>. The numerical scheme will then advect out of the domain (<strong>hyperbolic cleaning</strong>) and diffuse (<strong>parabolic cleaning</strong>). In practice, this requires to slightly modify the equations solved. Thus, the new conservative variable, primitive variable and associated flux become:</p>
<div class="arithmatex">\[
\begin{split}
\mathbf{U} &amp;= [\rho, \rho \mathbf{u}, E_{tot}, \mathbf{B}, \psi]^T\\
\mathbf{Q} &amp;= [\rho, \mathbf{u}, P_{tot}, \mathbf{B}, \psi]^T \\
\end{split}
\]</div>
<div class="arithmatex">\[
\mathbf{F}(\mathbf{Q}) = 
\begin{pmatrix}
 \rho u \\
 \rho u^2 + P_{tot} - B_x^2 \\
 \rho uv - B_xB_y \\
 \rho uw - B_xB_z \\
 (E_{tot}+P_{tot})u - B_z(\mathbf{u}\cdot\mathbf{B})\\ 
 \psi_m \\
 B_yu - B_xv \\
 B_zu - B_xw \\
 ch^2 B_{xm}
\end{pmatrix}
\]</div>
<p>With <span class="arithmatex">\(c_h\)</span> an hyperbolic cleaning constant that can be seen as an advection velocity. The values with subscripts <span class="arithmatex">\(m\)</span> are simply defined as the average between the quantities on each side of the interface when solving the Riemann problem.</p>
<p>Parabolic cleaning is done outside of the hyperbolic step and is straightforward: </p>
<div class="arithmatex">\[
\psi^{n+1}_i = \psi^{n*}e^{-\Delta t c_h^2/c_p^2}
\]</div>
<p>With <span class="arithmatex">\(\psi^{n*}\)</span> the value of <span class="arithmatex">\(\psi\)</span> in the cell after the hyperbolic update and <span class="arithmatex">\(c_p\)</span> a diffusion coefficient. As per (Dedner 2002) we set </p>
<div class="arithmatex">\[
c_h := \dfrac{C}{\Delta t}\min_{d={x,y,z}}(\Delta d)
\]</div>
<p>where <span class="arithmatex">\(C\)</span> is the limiting constant associated with the MHD CFL calculation. </p>
<p>To define <span class="arithmatex">\(c_p\)</span> we use a proxy parameter <span class="arithmatex">\(c_r\)</span> defined by the user, and such that </p>
<div class="arithmatex">\[
c_p = \sqrt{c_rc_h}
\]</div>
<p>The value of <span class="arithmatex">\(c_r\)</span> is left to the user, but by default is set to <span class="arithmatex">\(0.1\)</span> (see discussion after eq (46) in (Dedner 2002) for more information on this parameter).</p>
<h2 id="timestep-calculation">Timestep calculation</h2>
<p>TODO</p>
<h2 id="future-considerations">Future considerations</h2>
<ul>
<li>Implicit solvers for parabolic treatments</li>
<li>2nd order well-balanced scheme</li>
<li>All-Mach schemes</li>
<li>Constraint-Transport</li>
</ul>
<h2 id="references">References</h2>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>